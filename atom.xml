<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[My Octopress Blog]]></title>
  <link href="http://michaelochs.github.io/atom.xml" rel="self"/>
  <link href="http://michaelochs.github.io/"/>
  <updated>2014-04-13T13:20:05+02:00</updated>
  <id>http://michaelochs.github.io/</id>
  <author>
    <name><![CDATA[Your Name]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    
    <title type="html"><![CDATA[Implementing your own NSPersistentStore]]></title>
    <link href="http://michaelochs.github.io/blog/2014/04/13/implementing-your-own-nspersistentstore/"/>
    
    <updated>2014-04-13T13:18:00+02:00</updated>
    <id>http://michaelochs.github.io/blog/2014/04/13/implementing-your-own-nspersistentstore</id>
    
    <content type="html"><![CDATA[<h2>A quick overview</h2>

<p>The first thing that might come to mind when reading the headline is: Why? There already are a couple of stores available for you to choose from. And of course, as long as these fit your needs, you definitely don&rsquo;t want to do the heavy lifting your self and implement your own store.</p>

<h3>In-Memory</h3>

<p>The In-Memory store <code>NSInMemoryStoreType</code> is a store that, as the name suggests, stays completely in memory. It is never written to disk. If you or the system completely quits you app, all your data is gone. You typically would use this as a cache or store other data that can easily be reproduced.</p>

<h3>Binary</h3>

<p>The binary store <code>NSBinaryStoreType</code> is a store that is written on disk in one binary file. It is loaded into memory at once and it is written to disk at once. There is no incremental loading at all. You typically want to use this kind of store only for very small data. The benefit is that accessing data from it is pretty fast, once the store has loaded all the data from the disk.</p>

<h3>SQLite</h3>

<p>The <code>NSSQLiteStoreType</code> is what will match most of the database-like approaches. It stores its content into an sqlite database and can incrementally pull data out of it or push data into it. It is still pretty fast but you don&rsquo;t have to load all the data into memory. If you execute a fetch and the object is not already in the context that is executing the fetch or any parent context, it will load this particular object from disk without touching all the other objects that are stored in the sqlite database as well.</p>

<h3>XML</h3>

<p>The XML store type <code>NSXMLStoreType</code> is not available on iOS. It uses an XML data structure to store its elements. It is completely loaded into memory, like the binary store type. The big difference here is, that you can open XML stores with any other tool that is capable of reading XML data.</p>

<h2>Your store</h2>

<p>The XML store shows why you maybe want or need to implement your own store: If you have a given data format and want to operate on this data but don&rsquo;t want to miss the convenience of CoreData you can either choose to convert the data and store it into one of the given store types or you can write your own store and directly operate on your data. The last approach is very useful if there are other applications that need to use the data or if there is somebody who is constantly managing the data by hand, e.g. in a csv file. Instead of always converting between an existing CoreData store and the csv file, you can create a store that is capable of reading and writing this csv file directly.</p>

<h3>NSPersistentStoreCoordinator</h3>

<p>When using CoreData, you don&rsquo;t use the NSPersistentStore your self. Instead, you talk to your NSManagedObjectContext which walks up the context context hierarchy &ndash; as long as there is one &ndash; and finally talks to the NSPersistentStoreCoordinator. The NSPersistentStoreCoordinator hands the objects to the NSPersistentStore. The coordinator however is capable of handling multiple stores and &ndash; as long as each entity type is only assigned to one store &ndash; automatically decides which object goes to which store. This behaviour makes room for a couple of other interesting use cases. One example: You are writing a twitter client and need to store a number of twitter timelines in your application. You save these posts in CoreData as it is really easy to set up a table view with CoreData and an NSFetchedResultsController. However, the credentials of the user accounts in your application should be stored in a secure way, so you put them in the KeyChain. You are always dealing with two data storing approaches. With your own custom store, you can create a User entity that holds the credentials for one user and then assign this entity to a store that writes all the informations into the keychain whereas all the other data is stored in an sqlite store type. If you choose this approach, CoreData handles this process completely transparent for the rest of your application. You create User objects and tweet objects in the same context, you save them and the User entity is automatically stored in the key chain.</p>
]]></content>
    
  </entry>
  
  <entry>
    
    <title type="html"><![CDATA[An improved way to integrate Reveal into your Xcode project]]></title>
    <link href="http://michaelochs.github.io/blog/2013/11/23/an-improved-way-to-integrate-reveal-into-your-xcode-project/"/>
    
    <updated>2013-11-23T14:06:00+01:00</updated>
    <id>http://michaelochs.github.io/blog/2013/11/23/an-improved-way-to-integrate-reveal-into-your-xcode-project</id>
    
    <content type="html"><![CDATA[<p>Oliver Jones had a great article at the Itty Bitty Apps Blog about how to &lsquo;<a href="http://blog.ittybittyapps.com/blog/2013/11/07/integrating-reveal-without-modifying-your-xcode-project">Integrating Reveal without modifying your Xcode project</a>&rsquo; that was also featured in <a href="http://iosdevweekly.com/issues/120" title="iOS Dev Weekly Issue #120">iOS dev weekly</a>. Reveal is a great tool to debug layout issues. I highly encourage everybody to <a href="http://revealapp.com" title="Reveal website">check it out</a>. It improves debugging UI related issues like <code>UIView</code> position and clipping or <code>CALayer</code> ordering and really makes your life easier. Oliver&rsquo;s blog post explained a great way to integrate Reveal into your Xcode project without linking it automatically and without having it automatically starting up during app start. There are a couple of benefits with this approach.</p>

<!--more-->


<p>As the library is not linked automatically it is not discovered by Apple&rsquo;s static analyzer. This is great in the case that you forget to remove it before submitting to the App Store. I don&rsquo;t know if the Reveal library contains private APIs, but as it is a library that is meant to be used during development, I would consider this a possibility, if not at the moment maybe in the future.</p>

<p>The other benefit is that, as the Reveal service is not automatically run at app launch, you can debug your app without interference of the library and only fire up the library when you really need it. In the case you forget to remove it before the App Store build, people that get your app through the App Store still are not able to analyze your view hierarchy with Reveal.</p>

<p>A third great improvement is very useful for all the people that are working in a big office with dozens of other developers. If you have the Reveal library enabled in every build everybody makes, it becomes quite a challenge to select the right device in Reveal. You only want the Reveal service up and running when you really want to debug something.</p>

<p>Oliver used the LLDB init file <code>~/.lldbinit</code> to add a couple of aliases to load and start the Reveal library from the debugger:</p>

<ul>
<li><code>reveal_load_sim</code> &ndash; loads the Reveal library in the iOS simulator</li>
<li><code>reveal_load_dev</code> &ndash; loads the Reveal library on the device</li>
<li><code>reveal_start</code> &ndash; starts the Reveal library</li>
<li><code>reveal_stop</code> &ndash; stops the Reveal library</li>
</ul>


<p>However there are a couple of issues with the described approach that bothered me and that don&rsquo;t work very well with the workflow we have in the company I work at:</p>

<p>You still need to add the library to the copy step of your project file. Chances are high that you forget to remove this before running the App Store build. Even though the library is neither linked nor started automatically you don&rsquo;t want a library that you don&rsquo;t need and that increases your app by almost 4MB in your App Store ipa. This might make the difference between being downloadable through WiFi only or not. Besides that, it looks unprofessional in the case someone discovers this and it might open some security threads you don&rsquo;t think of.</p>

<p>When adding the library to your copy step you have two options: Use the library that is located in the <code>Reveal.app</code> folder or copy it to your project. In the first case you break the build process for everybody that doesn&rsquo;t have Reveal installed as the file will not be in the place where Xcode is looking for it. With the second approach you will run in to problems when different engineers have different versions of Reveal on their machines. it is pretty likely anyway that you will forget to update the library in the first place and only notice this when you really need it. Updating the library requires you to stop the running application and rebuild it after you updated the library. This reduces the benefit of the automatic approach dramatically.</p>

<p>Last but not least I don&rsquo;t want to have two load commands, <code>reveal_load_sim</code> and <code>reveal_load_dev</code>. This is more complicated than it should be. The debugger should be able to figure that out by itself or at best use the exact same approach on the device and simulator.</p>

<h2>reveal_load</h2>

<p>Let&rsquo;s try to fix that little inconvenience first. With Oliver&rsquo;s approach we use the following aliases:</p>

<figure class='code'><figcaption><span>~/.lldbinit </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>command alias reveal_load_sim expr (void*)dlopen("/Applications/Reveal.app/Contents/SharedSupport/iOS-Libraries/libReveal.dylib", 0x2);
</span><span class='line'>command alias reveal_load_dev expr (void*)dlopen([(NSString*)[(NSBundle*)[NSBundle mainBundle] pathForResource:@"libReveal" ofType:@"dylib"] cStringUsingEncoding:0x4], 0x2);</span></code></pre></td></tr></table></div></figure>


<p>The first alias is <code>reveal_load_sim</code>. It loads the Reveal library from the <code>Reveal.app</code> folder. This is a path that you obviously can only reach in the simulator. The second alias, <code>reveal_load_dev</code>, loads the <code>libReveal.dylib</code> from the application bundle. This only works when you add the library to your copy step before.</p>

<p>When you need to copy and update the library manually within your project it is quite helpful to be able to use Reveal in the simulator without copying the library first. As we try to improve this behavior in the next step anyway, let&rsquo;s simply remove the <code>reveal_load_sim</code> macro and rename <code>reveal_load_dev</code> to <code>reveal_load</code>. Our complete list of Reveal aliases in the <code>~/.lldbinit</code> now looks like this:</p>

<figure class='code'><figcaption><span>~/.lldbinit </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>command alias reveal_load expr (void*)dlopen([(NSString*)[(NSBundle*)[NSBundle mainBundle] pathForResource:@"libReveal" ofType:@"dylib"] cStringUsingEncoding:0x4], 0x2);
</span><span class='line'>command alias reveal_start expr (void)[(NSNotificationCenter*)[NSNotificationCenter defaultCenter] postNotificationName:@"IBARevealRequestStart" object:nil];
</span><span class='line'>command alias reveal_stop expr (void)[(NSNotificationCenter*)[NSNotificationCenter defaultCenter] postNotificationName:@"IBARevealRequestStop" object:nil];</span></code></pre></td></tr></table></div></figure>


<h2>Using a script instead of the copy phase</h2>

<p>Now that we optimized the load command let&rsquo;s make sure that we always have the library version that our currently installed version of Reveal needs and that Reveal is not included if it is not available on the machine that is performing the build. Instead of adding the framework to the copy step we simply use a &lsquo;run script&rsquo; phase in our build progress to copy the framework into the .app folder. This script can check for the configuration you are currently building and wether the framework exists in the <code>Reveal.app</code> folder.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">APPBUNDLEPATH</span><span class="o">=</span><span class="s2">&quot;${TARGET_BUILD_DIR}/${EXECUTABLE_NAME}.app/&quot;</span>
</span><span class='line'><span class="nv">REVEALFRAMEWORKPATH</span><span class="o">=</span><span class="s2">&quot;/Applications/Reveal.app/Contents/SharedSupport/iOS-Libraries/libReveal.dylib&quot;</span>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> -f <span class="s2">&quot;${REVEALFRAMEWORKPATH}&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="s2">&quot;${CONFIGURATION}&quot;</span> !<span class="o">=</span> <span class="s2">&quot;ReleaseAppStore&quot;</span> <span class="o">]</span>; <span class="k">then</span>
</span><span class='line'><span class="k"> </span>cp <span class="s2">&quot;${REVEALFRAMEWORKPATH}&quot;</span> <span class="s2">&quot;${APPBUNDLEPATH}&quot;</span>
</span><span class='line'><span class="k">fi</span>
</span></code></pre></td></tr></table></div></figure>


<p>The first line defines the path to the .app folder of the application we are building. The second line defines the location of the <code>libReveal.dylib</code> file if you have a standard Reveal installation. Now we only have to perform two checks:</p>

<ul>
<li><em>Does the libReveal.dylib file exist?</em> This is the first part of the condition and makes sure the build is successful on machines that do not have Reveal installed or where Reveal is installed in a different location.</li>
<li><em>Is the configuration we are currently building NOT <code>ReleaseAppStore</code>?</em> This is the configuration we are using for App Store distribution. You might need to change this to meet your environment. Maybe you are simply using the default <code>Release</code> build for App Store distribution or maybe you have another configuration name. Simply replace <code>ReleaseAppStore</code> to whatever configuration you are using. This ensures that the library is only copied when you are not building for the App Store.</li>
</ul>


<p>If you save this file somewhere in your project path, all you have to do is add a &lsquo;run script&rsquo; phase to your project and call this project by inserting the following line in the phase:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>bash <span class="s2">&quot;MyProject/Supporting Files/lazy-copy-reveal.sh&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Adjust this path to meet your environment and you are ready to go.</p>

<p>With this script and the above LLDB aliases everybody that has Reveal installed can simply pause the application at any time in the debugger and simply type <code>reveal_load</code> followed by <code>reveal_start</code>. After that, don&rsquo;t forget to resume your application. You can now immediately attach Reveal to your device. The library that is used in your project will automatically stay up to date with your Reveal version and you don&rsquo;t have to change anything in your project before submitting to the App Store.</p>

<p>I am only using this approach for a couple of days now and it has already been very useful as you can fire up Reveal anytime you have a UI issue without the need of restarting the application and reproducing the bug first.</p>

<p>I uploaded the two files you need to gist in the case you want to simply copy them:</p>

<ul>
<li><code>.lldbinit</code>: <a href="https://gist.github.com/michaelochs/7614557" title=".lldbinit on gist">https://gist.github.com/michaelochs/7614557</a></li>
<li><code>lazy-copy-reveal.sh</code>: <a href="https://gist.github.com/michaelochs/7614574" title="lazy-copy-reveal.sh on gist">https://gist.github.com/michaelochs/7614574</a></li>
</ul>

]]></content>
    
  </entry>
  
  <entry>
    
    <title type="html"><![CDATA[Drawing buttons with blurred background]]></title>
    <link href="http://michaelochs.github.io/blog/2013/05/09/drawing-buttons-with-blurred-background/"/>
    
    <updated>2013-05-09T17:25:00+02:00</updated>
    <id>http://michaelochs.github.io/blog/2013/05/09/drawing-buttons-with-blurred-background</id>
    
    <content type="html"><![CDATA[<p>A glossy looking button is a well known and widely used type of button that everybody knows if he or she hasn&rsquo;t been on the moon the last couple of years. Apple uses these buttons excessive. In OS X as well as on iOS. Those buttons look nice and they work very well when trying to achieve a polished, three dimensional look. However, they are always used with a background color that differs from the surrounding background or the surrounding background doesn&rsquo;t have much detail. This is because if you use this button on a background that has a lot of detail, like a photo, they don&rsquo;t look like glass anymore, at all. The button looks very flat if you can see, that the background isn&rsquo;t distorted by the &lsquo;glass&rsquo; in any kind.</p>

<!-- more -->


<h2>CoreImage</h2>

<p>The solution to this problem sounds quite easy at first: As soon as you simply blur the background just a little, the whole thing starts looking great again. This is where CoreImage comes in handy. CoreImage has a ton of useful filters, one of them is a gaussian blur filter. Using this filter is pretty easy. All you need to do is specify you input image and the blur radius you would like to use.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">CIFilter</span><span class="o">*</span> <span class="n">blur</span> <span class="o">=</span> <span class="p">[</span><span class="n">CIFilter</span> <span class="nl">filterWithName:</span><span class="s">@&quot;CIGaussianBlur&quot;</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">blur</span> <span class="nl">setValue:</span><span class="err">@</span><span class="p">(</span><span class="n">blurRadius</span><span class="p">)</span> <span class="nl">forKey:</span><span class="s">@&quot;inputRadius&quot;</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">blur</span> <span class="nl">setValue:</span><span class="n">inputImage</span> <span class="nl">forKey:</span><span class="s">@&quot;inputImage&quot;</span><span class="p">];</span>
</span><span class='line'><span class="n">CIImage</span><span class="o">*</span> <span class="n">outputImage</span> <span class="o">=</span> <span class="p">[</span><span class="n">blur</span> <span class="n">outputImage</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Note that you are dealing with <code>CIImage</code>&rsquo;s instead of <code>UIImage</code>&rsquo;s. So <code>inputImage</code> has to be a <code>CIImage*</code>.</em></p>

<h2>What to blur?</h2>

<p>Now that we know how to blur, the question would be: What to blur? And here is the point where things are getting difficult. There are three methods on CALayer that sound promising:</p>

<ul>
<li><code>setBackgroundFilters:</code> <em>&ldquo;An array of Core Image filters to apply to the content immediately behind the layer&rdquo;</em></li>
<li><code>setFilters</code>: <em>&ldquo;An array of Core Image filters to apply to the contents of the layer and its sublayers&rdquo;</em></li>
<li><code>setCompositingFilter</code>: <em>&ldquo;A CoreImage filter used to composite the layer and the content behind it&rdquo;</em></li>
</ul>


<p>All three methods are available on iOS, you can call them, the filters are set and they will be returned if you call the getter. But that&rsquo;s pretty much all these methods do, at least up to iOS6. Under <em>&ldquo;special considerations&rdquo;</em> Apple says <em>&ldquo;This property is not supported on layers in iOS&rdquo;</em>. Note that there was an error in the documentation on iOS 6.0, where it said <em>&ldquo;This property relies on the presence of Core Image and its filters. In iOS, Core Image is available in iOS 5 and later only&rdquo;</em>. They changed this in the iOS 6.1 documentation, so don&rsquo;t wonder if you see the second text, you selected the <em>old</em> version of the <code>CALayer</code> documentation.</p>

<p>So using one of these properties won&rsquo;t work on iOS. The only other approach I am aware of on iOS, is to render the underlaying layers into a context and blur it yourself. You can do this with <code>CALayer</code> again. The method you are looking for is <code>-[CALayer renderInContext:]</code></p>

<p>This method renders the receiver and it&rsquo;s sublayers to the context you specify. &lsquo;But I want to render the views!&rsquo; you might think. That&rsquo;s correct, but <code>UIView</code> is just the delegate of the underlying layer. Each <code>UIView</code> has a layer it is responsible for and the layer hierarchy is the same as the view hierarchy &ndash; unless you change something about this by yourself. The visible part of a <code>UIView</code> is the <code>CALayer</code>! If a view has five subviews, its layer has five sublayers and each of these sublayers belong to one of the subviews.</p>

<h2>Drawing</h2>

<p>To render the background of the button we want to blur, we simply walk up the view hierarchy until we find the first view that is opaque. If the view is opaque we can safely render this view and its subviews without worrying about transparent parts from underlaying views.</p>

<p>To achieve this, we create a new graphics context in the size of the button that should get the blurred background. We don&rsquo;t need to render the whole superview we just found, as we only need to blur the part that is behind our button. The rendered image is what we will use as our input image for the blur filter. Don&rsquo;t forget to hide the button during rendering, otherwise the button itself will be contained in the button&rsquo;s background.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">self</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="n">YES</span><span class="p">;</span>
</span><span class='line'>  
</span><span class='line'><span class="n">CGRect</span> <span class="n">renderRect</span> <span class="o">=</span> <span class="p">[</span><span class="n">viewToRender</span> <span class="nl">convertRect:</span><span class="n">rect</span> <span class="nl">fromView:</span><span class="n">self</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="n">UIGraphicsBeginImageContext</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">CGContextTranslateCTM</span><span class="p">(</span><span class="n">UIGraphicsGetCurrentContext</span><span class="p">(),</span> <span class="o">-</span><span class="n">CGRectGetMinX</span><span class="p">(</span><span class="n">renderRect</span><span class="p">),</span> <span class="n">CGRectGetMaxY</span><span class="p">(</span><span class="n">renderRect</span><span class="p">));</span>
</span><span class='line'><span class="n">CGContextScaleCTM</span><span class="p">(</span><span class="n">UIGraphicsGetCurrentContext</span><span class="p">(),</span> <span class="mf">1.0f</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0f</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">viewToRender</span><span class="p">.</span><span class="n">layer</span> <span class="nl">renderInContext:</span><span class="n">UIGraphicsGetCurrentContext</span><span class="p">()];</span>
</span><span class='line'>
</span><span class='line'><span class="n">CGImageRef</span> <span class="n">blurInputReference</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIGraphicsGetImageFromCurrentImageContext</span><span class="p">()</span> <span class="n">CGImage</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="n">UIGraphicsEndImageContext</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="n">self</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="n">NO</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After rendering the view into a <code>CGImage</code> we convert this to a <code>CIImage</code> and set it as the input image of our blur filter. If you put all this code into your button&rsquo;s <code>drawInRect:</code> method, you can then draw the output image into the current context for displaying. After that, you can call all the other drawing code, if any, you need for your button.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">CIImage</span><span class="o">*</span> <span class="n">inputImage</span> <span class="o">=</span> <span class="p">[</span><span class="n">CIImage</span> <span class="nl">imageWithCGImage:</span><span class="n">blurInputReference</span><span class="p">];</span>
</span><span class='line'><span class="n">CGImageRef</span> <span class="n">blurOutput</span> <span class="o">=</span> <span class="p">[</span><span class="n">context</span> <span class="nl">createCGImage:</span><span class="n">outputImage</span> <span class="nl">fromRect:</span><span class="n">outputImage</span><span class="p">.</span><span class="n">extent</span><span class="p">];</span>
</span><span class='line'><span class="n">CGContextDrawImage</span><span class="p">(</span><span class="n">UIGraphicsGetCurrentContext</span><span class="p">(),</span> <span class="n">outputImage</span><span class="p">.</span><span class="n">extent</span><span class="p">,</span> <span class="n">blurOutput</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Not that we render the output image with the extent of the <code>CIImage</code> as the blur filter will return an image that is larger than your input image. The extent property of you output image has a negative origin so that rendering the image with this extent will place your image exactly above your input image, with a border.</em></p>

<h2>BCBlurView on GitHub</h2>

<p>I have set up a <a href="https://github.com/michaelochs/BCBlurView" title="BCBlurView on github">GitHub project</a> that adds a method to <code>UIView</code> that renders the view&rsquo;s background with a given blur radius into the current context. You can call this method on any UIView in it&rsquo;s <code>drawRect:</code> method to get a blurred background. The static library also contains two subclasses, one of UIView and one of UIButton. Those adopt this category and, aside from others, make the blur radius available as a property for easier use.</p>

<h2>Special considerations</h2>

<p>This approach only works with still backgrounds. If you have any kind of animation in the background, this will not work. If the background changes, you have to call <code>setNeedsDisplay</code> on the view that has the blurred background. Note that blurring takes time, it is not possible to e.g. put a <code>UIScrollView</code> in the back of the button and call <code>setNeedsDisplay</code> on every scroll position change of the scroll view.</p>
]]></content>
    
  </entry>
  
  <entry>
    
    <title type="html"><![CDATA[Welcome]]></title>
    <link href="http://michaelochs.github.io/blog/2013/05/05/welcome/"/>
    
    <updated>2013-05-05T18:26:00+02:00</updated>
    <id>http://michaelochs.github.io/blog/2013/05/05/welcome</id>
    
    <content type="html"><![CDATA[<p>Welcome to ios-coding! My name is Michael Ochs, I am an iOS software engineer working in Cologne. This blog will deal with iOS development and things Apple does, from a developers perspective. I am writing about open source projects I use or participate in and about code samples I find useful during my work. I hope you will find useful ideas and tips on this blog and enjoy reading it. If you want to find out more about myself, check out the <a href="http://michaelochs.github.io/about">about page</a>.</p>
]]></content>
    
  </entry>
  
</feed>